---
// Pricing COMPLETO - Todas as features da tabela oficial com ver mais/menos

const plans = [
  {
    name: 'Pro',
    price: 'R$ 65',
    period: '/usuário',
    description: 'Ideal para trabalho em equipe, departamentos ou pequenos negócios.',
    includes: 'Inclui Pessoal, mais:',
    features: [
      '5 Assentos Incluídos',
      '10 GB Incluídos',
      { 
        text: 'Assento Convidado Gratuito', 
        tooltip: 'Convidado em demandas e campanhas, convidado em equipes. Solicitante em quadros ou visualizador em workspaces' 
      },
      'Workspaces Profissionais',
      'Projetos e Campanhas',
      'Equipes',
      'Gestão de Arquivos',
      'Aprovações de Arquivos e Textos',
      'Comunicador Integrado',
      'Calendários e Comunicador',
      'Suporte - Tickets'
    ],
    cta: 'Agendar Demo',
    highlight: false
  },
  {
    name: 'Business',
    price: 'R$ 95',
    period: '/usuário',
    badge: 'Mais popular',
    description: 'Perfeito para negócios estabelecidos que querem escalar.',
    includes: 'Inclui Pro, mais:',
    features: [
      '10 Assentos Incluídos',
      '50 GB Incluídos',
      { 
        text: 'Assento Convidado Gratuito', 
        tooltip: 'Convidado em demandas e campanhas, convidado em equipes. Solicitante em quadros ou visualizador em workspaces' 
      },
      'Portais de Relacionamento',
      'Organização Hierárquica',
      'White Label',
      'Copilot',
      'Gestão de Pessoas',
      'Time-Tracking',
      'Integrações Nativas',
      'Gerente de Sucesso',
      'Suporte Prioritário'
    ],
    cta: 'Agendar Demo',
    highlight: true
  },
  {
    name: 'Enterprise',
    price: 'Consulte',
    description: 'Ambiente customizável e adaptável a organizações maiores.',
    includes: 'Inclui Business, mais:',
    features: [
      'Assentos sob consulta',
      'Armazenamento sob consulta',
      { 
        text: 'Assento Convidado Gratuito', 
        tooltip: 'Convidado em demandas e campanhas, convidado em equipes. Solicitante em quadros ou visualizador em workspaces' 
      },
      'Permissionamento Organizacional',
      'Subcontas',
      'Single Sign-On / SAML',
      'Métricas e Painel B.I',
      'Integrações Personalizadas',
      'Programa de Onboarding',
      'Programa de Treinamento',
      'Gerente de Contas',
      'Suporte Personalizado'
    ],
    cta: 'Agendar Demo',
    highlight: false
  }
];
---

<section id="pricing" class="py-[6rem] bg-white fade-section">
  <div class="max-w-[80rem] mx-auto px-[0.5rem] md:px-[1.5rem] lg:px-[2rem]">
    
    <!-- Header -->
    <div class="text-center mb-[3rem]">
      <p class="text-[0.875rem] font-medium text-[#6D28D9] mb-[0.5rem]">Preços</p>
      <h2 class="text-[2rem] sm:text-[2.5rem] font-semibold text-[#0A0A0A] mb-[0.5rem]">
        Preços claros. Sem surpresas.
      </h2>
      <p class="text-[1rem] text-[#737373]">
        Cancele quando quiser. Sem fidelidade.
      </p>
    </div>
    
    <!-- Grid de planos -->
    <div class="grid md:grid-cols-3 gap-[1rem] items-stretch max-w-[70rem] mx-auto">
      {plans.map((plan, index) => (
        <div class={`pricing-card relative flex flex-col p-[1.5rem] rounded-[0.75rem] border transition-all duration-200 ${
          plan.highlight 
            ? 'bg-[#1a1625] border-[#1a1625] text-white shadow-xl' 
            : 'bg-white border-[#E5E5E5] hover:border-[#6D28D9]/30'
        }`} data-plan={index}>
          
          {/* Badge */}
          {plan.badge && (
            <div class="absolute -top-[0.75rem] left-1/2 -translate-x-1/2 px-[0.75rem] py-[0.25rem] bg-[#6D28D9] text-white text-[0.6875rem] font-medium rounded-full">
              {plan.badge}
            </div>
          )}
          
          <h3 class={`text-[1.5rem] font-bold mb-[0.5rem] ${plan.highlight ? 'text-white' : 'text-[#0A0A0A]'}`}>
            {plan.name}
          </h3>
          
          <div class="mb-[1rem]">
            <span class={`text-[2.5rem] font-bold ${plan.highlight ? 'text-white' : 'text-[#0A0A0A]'}`}>
              {plan.price}
            </span>
            {plan.period && (
              <span class={`text-[1rem] ${plan.highlight ? 'text-white/60' : 'text-[#737373]'}`}>{plan.period}</span>
            )}
          </div>
          
          <p class={`text-[1.125rem] mb-[2rem] leading-relaxed ${plan.highlight ? 'text-white/70' : 'text-[#737373]'}`}>
            {plan.description}
          </p>
          
          {plan.includes && (
            <p class={`text-[0.9375rem] font-medium mb-[0.75rem] ${plan.highlight ? 'text-white/80' : 'text-[#0A0A0A]'}`}>
              {plan.includes}
            </p>
          )}
          
          <!-- Features (Todas visíveis) -->
          <ul class="features-list space-y-[0.75rem] mb-[1.5rem] flex-grow">
            {plan.features.map((feature, fIndex) => (
              <li class={`feature-item flex items-start gap-[0.75rem] text-[1rem] leading-snug ${plan.highlight ? 'text-white/80' : 'text-[#525252]'}`}>
                <svg class="w-[1.25rem] h-[1.25rem] flex-shrink-0 text-[#6D28D9] mt-[0.125rem]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
                
                {typeof feature === 'string' ? (
                  feature
                ) : (
                  <div class="flex items-center gap-[0.375rem] relative group cursor-help">
                    <span>{feature.text}</span>
                    <div class="relative">
                      <!-- Icon -->
                      <svg class={`w-[1rem] h-[1rem] opacity-70 group-hover:opacity-100 transition-opacity ${plan.highlight ? 'text-white' : 'text-[#6D28D9]'}`} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                      </svg>
                      
                      <!-- Tooltip Box -->
                      <div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-[0.5rem] w-[16rem] p-[0.75rem] bg-[#1a1625] text-white text-[0.875rem] rounded-[0.5rem] shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 pointer-events-none text-center leading-relaxed border border-white/10">
                        {feature.tooltip}
                        <!-- Arrow -->
                        <div class="absolute top-full left-1/2 -translate-x-1/2 -mt-[1px] border-[6px] border-transparent border-t-[#1a1625]"></div>
                      </div>
                    </div>
                  </div>
                )}
              </li>
            ))}
          </ul>
          
          <button onclick="openModal()" class="w-full py-[1rem] rounded-[0.5rem] font-bold text-[1rem] transition-all duration-300 cursor-pointer mt-auto bg-gradient-to-r from-[#7C3AED] to-[#DB2777] hover:brightness-110 text-white shadow-[0_0_20px_rgba(124,58,237,0.3)] hover:shadow-[0_0_40px_rgba(124,58,237,0.5)] hover:-translate-y-1">
            {plan.cta}
          </button>
          
        </div>
      ))}
    </div>
    
  </div>
</section>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.toggle-features').forEach(btn => {
      btn.addEventListener('click', () => {
        const planIndex = btn.dataset.plan;
        const card = document.querySelector(`.pricing-card[data-plan="${planIndex}"]`);
        const list = card.querySelector('.features-list');
        const isCollapsed = list.dataset.collapsed === 'true';
        
        // Toggle visibility of hidden items
        list.querySelectorAll('.feature-item').forEach(item => {
          const index = parseInt(item.dataset.index);
          if (index >= 5) {
            item.classList.toggle('hidden', !isCollapsed);
          }
        });
        
        // Update state
        list.dataset.collapsed = isCollapsed ? 'false' : 'true';
        
        // Update button text
        const text = btn.querySelector('.toggle-text');
        const icon = btn.querySelector('.toggle-icon');
        if (isCollapsed) {
          text.textContent = 'Ver menos';
          icon.style.transform = 'rotate(180deg)';
        } else {
          const hiddenCount = list.querySelectorAll('.feature-item[data-index]').length - 5;
          text.textContent = `Ver mais (${hiddenCount})`;
          icon.style.transform = 'rotate(0deg)';
        }
      });
    });
  });
</script>

<style>
  .fade-section {
    opacity: 0;
    transform: translateY(2rem);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }
  
  .fade-section.is-visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>
